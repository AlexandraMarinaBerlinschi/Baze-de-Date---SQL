--1
SELECT M.DENUMIRE
FROM MAGAZIN M
JOIN STOC S ON M.ID_MAGAZIN = S.COD_MAGAZIN
JOIN (
  SELECT MIN(PRET) AS PRET, COD_PRODUS
  FROM STOC
  GROUP BY COD_PRODUS
) T ON S.PRET = T.PRET AND S.COD_PRODUS = T.COD_PRODUS
JOIN PRODUS P ON S.COD_PRODUS = P.ID_PRODUS AND UPPER(P.DENUMIRE) LIKE 'NEXUS 7';

--2
SELECT P.DENUMIRE, C.DENUMIRE
FROM PRODUS P
JOIN CATEGORIE C ON C.ID_CATEGORIE = P.COD_CATEGORIE
WHERE EXISTS (
    SELECT *
    FROM PRODUCATOR P1
    WHERE P1.ID_PRODUCATOR = P.COD_PRODUCATOR AND P1.SERVICE IS NOT NULL
);

--3
SELECT P.NUME
FROM PRODUCATOR P
WHERE EXISTS (
    SELECT *
    FROM PRODUS P1
    JOIN STOC S ON P1.ID_PRODUS = S.COD_PRODUS
    JOIN MAGAZIN M ON S.COD_MAGAZIN = M.ID_MAGAZIN
    WHERE P1.COD_PRODUCATOR = P.ID_PRODUCATOR
    AND UPPER(M.ORAS) LIKE 'BUCURESTI'
)
AND NOT EXISTS (
    SELECT *
    FROM PRODUS P2
    JOIN STOC S2 ON P2.ID_PRODUS = S2.COD_PRODUS
    JOIN MAGAZIN M2 ON S2.COD_MAGAZIN = M2.ID_MAGAZIN
    WHERE P2.COD_PRODUCATOR = P.ID_PRODUCATOR
    AND UPPER(M2.ORAS) LIKE 'IASI'
);
    
--4
SELECT M.DENUMIRE, p.DENUMIRE
FROM STOC S, MAGAZIN M, PRODUS P
WHERE S.COD_MAGAZIN = M.ID_MAGAZIN AND S.COD_PRODUS = P.ID_PRODUS AND S.CANTITATE = (
    SELECT MAX(CANTITATE) FROM STOC S2
    WHERE S.COD_MAGAZIN = S2.COD_MAGAZIN
    )
ORDER BY M.DENUMIRE;
